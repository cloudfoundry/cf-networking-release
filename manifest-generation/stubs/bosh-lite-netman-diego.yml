---
netman_overrides:
  releases:
  - name: netman
    version: latest
  driver_templates:
  - name: garden-cni
    release: netman
  - name: cni-flannel
    release: netman
  - name: netmon
    release: netman
  - name: vxlan-policy-agent
    release: netman
  properties:
    vxlan-policy-agent:
      policy_server_url: http://policy-server.service.cf.internal:4003
      garden_address: 127.0.0.1:7777
      garden_protocol: tcp
    garden-cni:
      cni_plugin_dir: /var/vcap/packages/flannel/bin
      cni_config_dir: /var/vcap/jobs/cni-flannel/config/cni
    cni-flannel:
      etcd_endpoints:
      - https://cf-etcd.service.cf.internal:4001
      etcd_client_cert: |
        -----BEGIN CERTIFICATE-----
        MIIEITCCAgmgAwIBAgIQXzgaGyInxuKifX8eHnT28TANBgkqhkiG9w0BAQsFADAR
        MQ8wDQYDVQQDEwZldGNkQ0EwHhcNMTYwOTI5MTg0NTEyWhcNMTgwOTI5MTg0NTEy
        WjAVMRMwEQYDVQQDEwpjbGllbnROYW1lMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8A
        MIIBCgKCAQEAtD8uN0RNF/Dm4P0E4f+F1XdsL2OsSz8ZWSAV9BuqFvRuwOKCjSqg
        HbRzYanGYYIbPimuZEDJ3TH2qVtvjGStpuSmyTYpwiMe8xKglivDoBK2rs4cw1a2
        36qK3TgGhl2F1AiGrK7YZyLOnCOPskUbayifQnLlXyT86RUjvAqa/iJoEnU15Tt3
        +k+KKXctQIc/2tOW8C1Tr8XvIm9RsS3F/z7S1mQ91YmE78zRCOihEyr9PZBJkW4t
        02FyBO4cc+gJ2wagumZUrUxoLnQgD5RWMV25tUYSZu9DYYd+klpSTyQBhgOHMw/8
        LR5V3cTwjY9erNcqjofbG92cpiIhn0qa8QIDAQABo3EwbzAOBgNVHQ8BAf8EBAMC
        A7gwHQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMCMB0GA1UdDgQWBBSmDYGG
        wEv985OOV/kVuLlxYuDjsTAfBgNVHSMEGDAWgBT9AQdWRJ4e6aJOC79lF6DJw9Ne
        pTANBgkqhkiG9w0BAQsFAAOCAgEAJUUkjjdB5NCND/dQ/lIGzjJztd0/xD0ZQrC9
        RtOUYDep1Ds4RD8psObnESlceMx0AJ0nMxgX2GVFetEOj5nYTlj7P37joc3vfmDf
        WDGEvpNIWCyoV6Pk8qja24BYClDoi31DnMrZdX0Msi0rXA4TiGwT2D8wT6HarUdt
        zTBpfGNP3aQ5HCuiIVQBLXICTm9+y8JivRymYeQdKrw6Na41mhagf2+KrfWNj6fT
        PvFsFHdPh7TF4aFk6yCXkpnVAFLQ8TGZrt8jgqslLqTuGN8truF0EakAkYdnFIFn
        9C3XuIKpb7t+qVk17KdnVPZkmL/O5zCdk6ixfsF1g5WVs/I6EVQg9yMgKubDw43U
        gnOPAB2jmAZWcQgw+FiMOm1P4Nf+9qXX3mrxlixAm9mf8njTONH3V87npHjj/g2g
        L/gYLcOlseyHAQ1R0+5EmkmKz661l7EDC4tqy9+CETJWAaD/AlrqQ2MjbrJlK0IH
        rb48qqVXzcsj/liA51PPp660EPJg8pvvLOoBZrGsWTCGlgCFQecmJD2KVsbi4YaO
        Vz7aSBPJeQJ+zHZes7v32BLvmJ9819EuTrNB0Mpkv9W1b9YOt86F8ptmqWWGSBAK
        dSPwY+8Fa6U2LX+dbFR3qj2iHxx+gwhAPfuSZKNx1bAb0XbU2+Gtjxo+XgDSB4MM
        yzwNNQQ=
        -----END CERTIFICATE-----
      etcd_client_key: |
        -----BEGIN RSA PRIVATE KEY-----
        MIIEpAIBAAKCAQEAtD8uN0RNF/Dm4P0E4f+F1XdsL2OsSz8ZWSAV9BuqFvRuwOKC
        jSqgHbRzYanGYYIbPimuZEDJ3TH2qVtvjGStpuSmyTYpwiMe8xKglivDoBK2rs4c
        w1a236qK3TgGhl2F1AiGrK7YZyLOnCOPskUbayifQnLlXyT86RUjvAqa/iJoEnU1
        5Tt3+k+KKXctQIc/2tOW8C1Tr8XvIm9RsS3F/z7S1mQ91YmE78zRCOihEyr9PZBJ
        kW4t02FyBO4cc+gJ2wagumZUrUxoLnQgD5RWMV25tUYSZu9DYYd+klpSTyQBhgOH
        Mw/8LR5V3cTwjY9erNcqjofbG92cpiIhn0qa8QIDAQABAoIBAFLTUYZd4Vsl/MHY
        In1DMJmV5eWk1JBDL3+v6cahS7h+m8IQk9MQikD8IaT4Icu+wIwBFTzGNLxq8CCE
        fq6xuMYe/bEqLWgjQV6K6bX36E3PK5kJ51evqhr/QA5FZ2Io6Y00WcZSFejWqsA+
        6xINBXtpUD11lIby9TCZ4TDQYsZx/OLvDSdX0p3ycOk7onPGPdqda9qFtkyAJP09
        Z0qbND/LUspYMDhzLZ+K2FGPOAGGMN2sBF9JljkxQbgaua/dx6FWB49fx7YZYB/q
        AyKliqulaJeTXXOk/gNjYcECp2A3A17LIqdTlmkEXuwNC+ih2p/hz3La3xnu3hCw
        6whjvlECgYEAxTWhHnyCulA5dGvvsoVgx0kPLobpTzImnZvfnP1yuujakducqLjA
        6msl7+9jYZbuGv0j0ds4dRaf90OH3EPk8GBN0vH6t2oTPKIZCKqertSxbsA1OqPW
        n33eM9FPThqM6cj6hFQmaMC0ZEuDLwmzmyJP8WnzukUTAQQhovOGO40CgYEA6fsD
        4cQYrBHfE+pbhlTC6dN5xG6oqvwKq5RLk4yQQHSGJlur21K8BZiQrTDRBNLmubRK
        NZCaVzOeHf4DtA5jP0xYPqcCcTz91T8IKF1hMarlbsvsK50GsISnUZF+sPnJh/vi
        q0ZutVPs0CsVZA+CwBVkiZATi912/HFtxjXsUfUCgYBZGO6vIF/Lnz0l/THxPNNJ
        lhd21NsJvcW2hVrUyakRCuzc4xR3Iel+v2QHb+c9ivwOU3ngcSOjutIQ24DBIieH
        9mqSuGKmhRUl2rJmuPcyU8PKHqqt0KHBsxM15AXpapNpeDS+nmov/4hAm+Er2j08
        BJeLoWvNJzH7zosH3PAzbQKBgQC7zbHo9ZgEDPgsKRC7eq9UNVzocRXK4DDEVWxw
        CwQB6EWA5lXD3d1y9GkzyhoLMCjnZ7Gk2uM3GQRR+IAKdv3sYZ/28eBA+f6XulcW
        5xTLY+tyChYPT6N97YvLKegxrty23FOsvATCYJGU6O/rd5OwD7u5ur4lpmYJ7BV7
        Ye7EPQKBgQCbruJUyZvbBLh+1nQV5AYxU2crVya5GoWr5iCo3oTxfgMM1o64LWpk
        m8KOduob/Wz8IpnEBoJk3Iqw1oO9cOAJ1/zDSPcn0kqnglOTLHuDcmsi7V1RSvmI
        mjJdYjxbG5NV7JX/jicHsedXWYRuPq5T5nAbBQQMugjeq1oHmy9ruw==
        -----END RSA PRIVATE KEY-----
      etcd_ca_cert: |
        -----BEGIN CERTIFICATE-----
        MIIE4jCCAsqgAwIBAgIBATANBgkqhkiG9w0BAQsFADARMQ8wDQYDVQQDEwZldGNk
        Q0EwHhcNMTYwOTI5MTg0NTA4WhcNMjYwOTI5MTg0NTExWjARMQ8wDQYDVQQDEwZl
        dGNkQ0EwggIiMA0GCSqGSIb3DQEBAQUAA4ICDwAwggIKAoICAQDMsXcH/kH8grnH
        l5FbGIYrfJ/O5AZZ3L/iZipUKByLdTu0TRf0nY7umPrc4eEKe9en7odG/QGewtRN
        QkIALBIS+jDy8JgTSQIfo4BzjeU7Ec4Yjf7UlGR9WhQcHdENbgliqpHHr4i3Ku9m
        AaqWS9sZ2t1Y1jvRjQ6rjNxV+QVg65UvhC34zDvdAyquUl1yS0IswUMlUmD9DwTY
        6TBXZCW+cyx7OOjm8sI7CIXJrVEGAwzjCsNlftJgQ4RPoRjUsavZraiiU+Igfp4b
        SYSAOgE+qlQ0nOMVH5hvgd2Lies2Liiq5qZSqyg345CX9YbkJIQxP6tDNqFsS+PS
        0wctJtShSL4YVVJiO8WhoVRmxPS56DJ5XE1Ksd6NHftqhocpCoISAxF9s1TeENPg
        N6e2fxT7Wx+gS/vH7zKozcdF7r2rKBOnPSwvKFlmWGVNFDNROfxm2TZEGkXDWIjA
        rRfi4vsaAXNTdpagTtNh8kPmdvO+hiNDvRo17GUkKXm0mt8o+jMjJctyjTycxsMG
        adlZSHrOe1LKzTb4Wy/e/93tBNWFJ/dKcYz4Ezhno5B2Cy9pVMlYrwTwnwnCAgrg
        UManVIrw2mf1m39bBkJu0KblYkQjTfSwIF3uee/CO+uhFQoNo1XPzABfbaCpuo5K
        WFPHt9mIf4V10n7yhmw+JETnL7D4swIDAQABo0UwQzAOBgNVHQ8BAf8EBAMCAQYw
        EgYDVR0TAQH/BAgwBgEB/wIBADAdBgNVHQ4EFgQU/QEHVkSeHumiTgu/ZRegycPT
        XqUwDQYJKoZIhvcNAQELBQADggIBAE6+8IAdGvh+Kuiej6dR1YEA7YnZFLT0IwlH
        fkSYGdMu/3VHhuhE7ksqKj4ppDMRUO16mf4iX65V0MP1h9dlJx0/YgWkLb+FMEcE
        f/S8e5dibcf4WfvHwlJtC962RY6ekeVLeGfyugnViuab09l8KoyFtLq3QAG/mN4w
        M8eMX3zp6/YdMUHhJrUu2CWnS+3zRrgjmVriZGdp7X2mnQj5T0eht4WoAOaanU/3
        Fz2RmUNZ6HRre72NudLBVLi2e1eM5LcpUst3TzSnBjEPz88doiNElbY5c5pbTX/p
        2QyD2ZObJRT+Cebq8qV6J6o6VnlrZ0XOLh6QS+3GHrflUx9lz6TMKdX0JTqjZUii
        Pt+t/RJCACZg+T6ixiBI/cN6w317KHrMwsaAMSDkJu/nrlN/gnxJcQxWT1e7udWG
        Q2YIgGjBa6REkZ4KYAIsiP2T9dcdJqKwWbzgp5Vnf9aoAUrgEVoNe6w/kIJTXGR2
        UO6yeSu09JMTWe3NGOXk8oZxtInp1/m55nbpmqPWiQBRmyrBea3F+92uO95q5GDj
        eL+BKRkE8SlmoDNNLIH3ttQvn2UEsHHgfX3NEuZzrQXJrLL6pmRRZ0GsQfj6IhkD
        tRxnBhxU9wQMiLDyvnux4bLv1NGZurGPcEO+8QQaJ52vi27Uggxe9uuV+oVo8dWa
        U+863OFY
        -----END CERTIFICATE-----
    policy-server:
      database:
        connection_string: postgres://networkpolicyadmin:admin@10.244.0.30:5524/networkpolicydb?sslmode=disable
        type: postgres
      skip_ssl_validation: true
      uaa_client_secret: network-policy-secret
      uaa_url: https://uaa.bosh-lite.com
      ca_cert: |
        foo
      server_cert: |
        foo
      server_key: |
        foo
  garden_properties:
    network_plugin: /var/vcap/packages/runc-cni/bin/garden-external-networker
    network_plugin_extra_args:
    - --configFile=/var/vcap/jobs/garden-cni/config/adapter.json
  jobs:
  - name: policy-server
    instances: 1
    persistent_disk: 256
    templates:
    - name: policy-server
      release: netman
    - name: route_registrar
      release: cf
    - name: consul_agent
      release: cf
    - name: metron_agent
      release: cf
    resource_pool: database_z1
    networks:
      - name: diego1
    properties:
      nats:
        machines:
        - 10.244.0.6
        password: nats
        port: 4222
        user: nats
      metron_agent:
        zone: z1
      route_registrar:
        routes:
        - name: policy-server
          port: 4002
          registration_interval: 20s
          uris:
          - api.bosh-lite.com/networking
      consul:
        agent:
          services:
            policy-server:
              name: policy-server
              check:
                interval: 5s
                script: /bin/true
